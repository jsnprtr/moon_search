const messageUtils = require('../messageutils.js');

test('Calling without a highlight returns an object with only the text', () => {
  const messageObj = new messageUtils.Message('some message', null).getMessage();

  expect(messageObj.text).toMatch('some message');
  expect(messageObj.fullText).toBe(undefined);
});

test('Calling with a highlight returns highlight as text if the message and highlight are the same text. fullText should be undefined', () => {
  const messageObj = new messageUtils.Message('some message', 'some <em>message</em>').getMessage();

  expect(messageObj.text).toMatch('some <em>message</em>');
  expect(messageObj.fullText).toBe(undefined);
});

test(`FullText is only populated if the highlight text is shorter than the full message
  - text is the highlight with ellipses in the appropriate place (at beginning only)
  - fullText is the full message with the highlight replaced`, () => {
  const messageObj = new messageUtils.Message('Well, scientifically, traditions are an idiot thing.', '<em>idiot</em> <em>thing</em>.').getMessage();

  expect(messageObj.text).toMatch('... <em>idiot</em> <em>thing</em>.');
  expect(messageObj.fullText).toMatch('Well, scientifically, traditions are an <em>idiot</em> <em>thing</em>.');
});

test(`FullText is only populated if the highlight text is shorter than the full message
  - text is the highlight with ellipses in the appropriate place (at end only)
  - fullText is the full message with the highlight replaced`, () => {
  const messageObj = new messageUtils.Message('Well, scientifically, traditions are an idiot thing.', '<em>Well</em>, scientifically').getMessage();

  expect(messageObj.text).toMatch('<em>Well</em>, scientifically...');
  expect(messageObj.fullText).toMatch('<em>Well</em>, scientifically, traditions are an idiot thing.');
});

test(`FullText is only populated if the highlight text is shorter than the full message
  - text is the highlight with ellipses in the appropriate place (at beginning and end)
  - fullText is the full message with the highlight replaced`, () => {
  const messageObj = new messageUtils.Message('Roger. From the hot wires of the Public Affairs Office: Apollo 11 still dominates the news around the world. Only four nations, Communist China, North Korea, North Viet Nam, and Albania, have not yet informed their citizens of your flight and landing on the Moon. One newsman said that he has run out of ways to describe your success. Tonight, President Nixon is scheduled to watch the All Star baseball game in Washington. After the game, he will depart for the Pacific recovery area. Wednesday evening, he will fly from Johnston Island by helicopter to the Navy communications ship Arlington. Then on Thursday morning, he will reboard the helicopter and fly to the Hornet in time to witness your splashdown. Accompanying the President will be Secretary of State William Rogers and Frank Borman. They will watch the splashdown from the bridge of the recovery ship with Admiral John Sidney McCain, Jr., Commander of the Pacific Forces. Following the President\'s stay aboard the Hornet, he will depart for his tour of Asia and scheduled visit to Romania. Luna 15 is believed to have crashed into the Sea of Crises yesterday after orbiting the Moon 52 times. The Soviet News Agency TASS reported that "scientific" "research in near Moon space was carried out." Sir Bernard Lovell at Jodrell Bank Observatory said that Luna 15 hit the surface of the Moon at a speed of about 300 miles per hour. Things have been relatively quiet recently in Viet Nam. GI\'s on patrol were observed carrying transistor radios tuned into your flight. The Armed Forces radio and TV network in Viet Nam gave the mission full coverage. Skirmishes still continue between the Egyptians and Israelis along the Suez Canal. U.N. observers there are trying to halt the action. In Washington, the House Ways and Means Committee has voted to reduce the 27.5 percent oil depletion allowance to 20 percent. We\'ve had rain several times here in the Houston area. Today it is cloudy, and more showers are expected. On the sports front, as we mentioned earlier, the All Star game is tonight. There were no games played yesterday. Last night in New York, the Baseball Writers Association of America named Babe Ruth the greatest ball player of all time. Joe DiMaggio was named the greatest living ball player. Frank Borman made the announcements at a dinner honoring the players. Joe Namath put in a full day at the New York Jets\' training camp. Five policemen had a hard time restraining about 500 kids who wanted to touch Broadway Joe. He said he feels fine and will play in the All Star game August 1, if Coach Weeb Eubank lets him. The Oilers\' camp at Kerrville got wet yesterday, but the workouts continued. There have been some minor injuries, but nothing too serious. Coach Wally Lemm is satisfied so far with the workouts. The Oilers are expecting attendance by over 30.000 for the preseason game with Buffalo. Apparently, Don Meredith\'s announced retirement isn\'t expected to dampen enthusiasm, especially around here in Houston. Mario Andretti won the 200 mile Trenton Auto Race Sunday and is now the leading race driver in the U.S. Auto Club\'s point standings. And that\'s about the summary of the morning news this afternoon in Houston. Over.', 'named <em>Babe</em> <em>Ruth</em> the greatest ball player of all time. Joe DiMaggio was named the greatest living ball').getMessage();

  expect(messageObj.text).toMatch('... named <em>Babe</em> <em>Ruth</em> the greatest ball player of all time. Joe DiMaggio was named the greatest living ball...');
  expect(messageObj.fullText).toMatch('Roger. From the hot wires of the Public Affairs Office: Apollo 11 still dominates the news around the world. Only four nations, Communist China, North Korea, North Viet Nam, and Albania, have not yet informed their citizens of your flight and landing on the Moon. One newsman said that he has run out of ways to describe your success. Tonight, President Nixon is scheduled to watch the All Star baseball game in Washington. After the game, he will depart for the Pacific recovery area. Wednesday evening, he will fly from Johnston Island by helicopter to the Navy communications ship Arlington. Then on Thursday morning, he will reboard the helicopter and fly to the Hornet in time to witness your splashdown. Accompanying the President will be Secretary of State William Rogers and Frank Borman. They will watch the splashdown from the bridge of the recovery ship with Admiral John Sidney McCain, Jr., Commander of the Pacific Forces. Following the President\'s stay aboard the Hornet, he will depart for his tour of Asia and scheduled visit to Romania. Luna 15 is believed to have crashed into the Sea of Crises yesterday after orbiting the Moon 52 times. The Soviet News Agency TASS reported that \"scientific\" \"research in near Moon space was carried out.\" Sir Bernard Lovell at Jodrell Bank Observatory said that Luna 15 hit the surface of the Moon at a speed of about 300 miles per hour. Things have been relatively quiet recently in Viet Nam. GI\'s on patrol were observed carrying transistor radios tuned into your flight. The Armed Forces radio and TV network in Viet Nam gave the mission full coverage. Skirmishes still continue between the Egyptians and Israelis along the Suez Canal. U.N. observers there are trying to halt the action. In Washington, the House Ways and Means Committee has voted to reduce the 27.5 percent oil depletion allowance to 20 percent. We\'ve had rain several times here in the Houston area. Today it is cloudy, and more showers are expected. On the sports front, as we mentioned earlier, the All Star game is tonight. There were no games played yesterday. Last night in New York, the Baseball Writers Association of America named <em>Babe</em> <em>Ruth</em> the greatest ball player of all time. Joe DiMaggio was named the greatest living ball player. Frank Borman made the announcements at a dinner honoring the players. Joe Namath put in a full day at the New York Jets\' training camp. Five policemen had a hard time restraining about 500 kids who wanted to touch Broadway Joe. He said he feels fine and will play in the All Star game August 1, if Coach Weeb Eubank lets him. The Oilers\' camp at Kerrville got wet yesterday, but the workouts continued. There have been some minor injuries, but nothing too serious. Coach Wally Lemm is satisfied so far with the workouts. The Oilers are expecting attendance by over 30.000 for the preseason game with Buffalo. Apparently, Don Meredith\'s announced retirement isn\'t expected to dampen enthusiasm, especially around here in Houston. Mario Andretti won the 200 mile Trenton Auto Race Sunday and is now the leading race driver in the U.S. Auto Club\'s point standings. And that\'s about the summary of the morning news this afternoon in Houston. Over.');
});